@tailwind base;
@tailwind components;
@tailwind utilities;

/* 性能优化的设计系统 - 减少CSS体积和重绘 */

@layer base {
  :root {
    /* 年轻活泼的渐变配色系统 - 优化版本 */
    --background: 280 15% 97%;
    --foreground: 230 15% 15%;

    --card: 280 30% 98%;
    --card-foreground: 230 15% 15%;

    --popover: 280 30% 98%;
    --popover-foreground: 230 15% 15%;

    /* 主色调：活力紫红渐变 */
    --primary: 315 85% 60%;
    --primary-foreground: 0 0% 98%;

    /* 次要色：明亮青蓝 */
    --secondary: 195 80% 50%;
    --secondary-foreground: 0 0% 98%;

    /* 静音色：浅紫灰 */
    --muted: 280 20% 92%;
    --muted-foreground: 230 25% 45%;

    /* 强调色：霓虹橙 */
    --accent: 25 95% 65%;
    --accent-foreground: 0 0% 98%;

    --destructive: 0 84% 60%;
    --destructive-foreground: 0 0% 98%;

    --border: 280 20% 85%;
    --input: 280 20% 90%;
    --ring: 315 85% 60%;

    --radius: 1rem;

    /* 性能优化的渐变和阴影 */
    --gradient-primary: linear-gradient(135deg, hsl(315, 85%, 60%), hsl(25, 95%, 65%));
    --gradient-secondary: linear-gradient(135deg, hsl(195, 100%, 85%), hsl(280, 70%, 85%));
    --gradient-accent: linear-gradient(135deg, hsl(25, 95%, 65%), hsl(315, 85%, 60%));
    
    --shadow-glow: 0 0 30px hsl(315, 85%, 60%, 0.3);
    --shadow-card: 0 10px 40px hsl(315, 85%, 60%, 0.1);

    --sidebar-background: 280 30% 98%;
    --sidebar-foreground: 230 15% 15%;
    --sidebar-primary: 315 85% 60%;
    --sidebar-primary-foreground: 0 0% 98%;
    --sidebar-accent: 280 20% 92%;
    --sidebar-accent-foreground: 230 15% 15%;
    --sidebar-border: 280 20% 85%;
    --sidebar-ring: 315 85% 60%;
  }

  .dark {
    /* 暗色模式：深紫+霓虹色年轻配色 */
    --background: 230 50% 6%;
    --foreground: 0 0% 95%;

    --card: 230 40% 10%;
    --card-foreground: 0 0% 95%;

    --popover: 230 40% 10%;
    --popover-foreground: 0 0% 95%;

    /* 主色调：霓虹紫红 */
    --primary: 315 100% 70%;
    --primary-foreground: 0 0% 5%;

    /* 次要色：深青蓝 */
    --secondary: 195 80% 25%;
    --secondary-foreground: 0 0% 95%;

    /* 静音色：深紫灰 */
    --muted: 230 30% 15%;
    --muted-foreground: 0 0% 65%;

    /* 强调色：霓虹橙 */
    --accent: 25 100% 70%;
    --accent-foreground: 0 0% 5%;

    --destructive: 0 100% 70%;
    --destructive-foreground: 0 0% 5%;

    --border: 230 30% 20%;
    --input: 230 30% 15%;
    --ring: 315 100% 70%;

    /* 暗色模式渐变 */
    --gradient-primary: linear-gradient(135deg, hsl(315, 100%, 70%), hsl(25, 100%, 70%));
    --gradient-secondary: linear-gradient(135deg, hsl(195, 80%, 50%), hsl(280, 70%, 50%));
    --gradient-accent: linear-gradient(135deg, hsl(25, 100%, 70%), hsl(315, 100%, 70%));
    
    --shadow-glow: 0 0 40px hsl(315, 100%, 70%, 0.4);
    --shadow-card: 0 10px 40px hsl(315, 100%, 70%, 0.2);

    --sidebar-background: 230 40% 8%;
    --sidebar-foreground: 0 0% 95%;
    --sidebar-primary: 315 100% 70%;
    --sidebar-primary-foreground: 0 0% 5%;
    --sidebar-accent: 230 30% 15%;
    --sidebar-accent-foreground: 0 0% 95%;
    --sidebar-border: 230 30% 20%;
    --sidebar-ring: 315 100% 70%;
  }
}

@layer base {
  * {
    @apply border-border;
  }

  body {
    @apply bg-background text-foreground;
    /* 性能优化 - 硬件加速和优化渲染 */
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    /* 提升滚动性能 */
    -webkit-overflow-scrolling: touch;
    /* 优化文本渲染 */
    text-rendering: optimizeLegibility;
    /* 减少重绘 */
    transform: translateZ(0);
    /* 启用硬件加速 */
    will-change: scroll-position;
  }

  /* 优化图片加载 - 防止CLS */
  img {
    /* 防止图片闪烁 */
    image-rendering: -webkit-optimize-contrast;
    image-rendering: crisp-edges;
    /* 懒加载占位 */
    background-color: hsl(var(--muted));
    /* 避免布局偏移 - 重要CLS优化 */
    display: block;
    width: 100%;
    height: auto;
    /* 预留空间避免布局跳动 */
    min-height: 1px;
  }

  /* 强制所有容器保持尺寸 */
  .aspect-ratio-container {
    position: relative;
    overflow: hidden;
  }

  .aspect-ratio-container::before {
    content: '';
    display: block;
    width: 100%;
  }

  /* 默认宽高比 */
  .aspect-ratio-container.aspect-video::before {
    padding-bottom: 56.25%; /* 16:9 */
  }

  .aspect-ratio-container.aspect-square::before {
    padding-bottom: 100%; /* 1:1 */
  }

  .aspect-ratio-container > * {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  /* 优化动画性能 */
  .animate-spin,
  .animate-pulse,
  .animate-bounce {
    /* 使用transform而不是改变layout属性 */
    will-change: transform;
    /* 启用硬件加速 */
    transform: translateZ(0);
  }

  /* 优化滚动性能 */
  .scroll-area {
    /* 启用滚动优化 */
    scroll-behavior: smooth;
    -webkit-overflow-scrolling: touch;
    /* 减少重绘 */
    contain: layout style paint;
  }

  /* 性能优化的按钮 */
  button,
  .btn {
    /* 避免不必要的重绘 */
    contain: layout style paint;
    /* 优化点击响应 */
    touch-action: manipulation;
  }

  /* 优化表格性能 */
  table {
    /* 固定表格布局以提升性能 */
    table-layout: fixed;
  }

  /* Critical CSS内联 - 关键样式 */
  .critical-above-fold {
    /* 首屏关键内容样式 */
    contain: layout style paint;
    will-change: auto;
  }
}

/* 性能优化的工具类 */
@layer utilities {
  /* GPU加速 */
  .gpu-accelerated {
    transform: translateZ(0);
    will-change: transform;
  }

  /* 严格的容器约束 - 防止CLS */
  .contain-paint {
    contain: layout style paint;
  }

  .contain-strict {
    contain: strict;
  }

  /* 聚餐卡片稳定布局 - 固定高度防止CLS */
  .dinner-card-stable {
    height: 280px;
    contain: strict;
    will-change: auto;
  }

  /* 优化的占位符 - 移除动画减少重绘 */
  .lazy-placeholder {
    background: hsl(var(--muted));
    contain: strict;
  }

  /* 性能优化的阴影 */
  .shadow-performance {
    box-shadow: 0 1px 3px 0 hsl(var(--primary) / 0.1);
  }

  /* 稳定容器 */
  .stable-container {
    min-height: 100px;
    contain: layout style paint;
  }

  /* 关键渲染路径优化 */
  .critical-path {
    contain: layout style;
    content-visibility: auto;
    contain-intrinsic-size: 280px;
  }

  /* 文本截断优化 */
  .line-clamp-1 {
    display: -webkit-box;
    -webkit-line-clamp: 1;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }

  .line-clamp-2 {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }

  /* 图标容器 - 防止布局偏移 */
  .icon-container {
    width: 1rem;
    height: 1rem;
    flex-shrink: 0;
    contain: layout style paint;
  }
}